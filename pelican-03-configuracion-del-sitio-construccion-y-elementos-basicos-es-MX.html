<!DOCTYPE html>
<html lang="en">
  <head>
    <meta charset="utf-8">
    <title>Pelican (03), configuración del sitio (construcción y elementos&nbsp;básicos)</title>
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="">
    <meta name="author" content="Penserbjorne">

    <!-- Le styles -->
    <link rel="stylesheet" href="https://penserbjorne.github.io/theme/css/bootstrap.dark.css" type="text/css" />
    <style type="text/css">
      body {
        padding-top: 60px;
        padding-bottom: 40px;
      }
      .sidebar-nav {
        padding: 9px 0;
      }
      .tag-1 {
        font-size: 13pt;
      }
      .tag-2 {
        font-size: 10pt;
      }
      .tag-2 {
        font-size: 8pt;
      }
      .tag-4 {
        font-size: 6pt;
     }
    </style>
    <link href="https://penserbjorne.github.io/theme/css/bootstrap-responsive.dark.css" rel="stylesheet">
        <link href="https://penserbjorne.github.io/theme/css/font-awesome.css" rel="stylesheet">

    <link href="https://penserbjorne.github.io/theme/css/pygments.css" rel="stylesheet">

    <!-- Le HTML5 shim, for IE6-8 support of HTML5 elements -->
    <!--[if lt IE 9]>
      <script src="//html5shim.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->

    <!-- Le fav and touch icons -->
    <link rel="shortcut icon" href="https://penserbjorne.github.io/theme/images/favicon.ico">
    <link rel="apple-touch-icon" href="https://penserbjorne.github.io/theme/images/apple-touch-icon.png">
    <link rel="apple-touch-icon" sizes="72x72" href="https://penserbjorne.github.io/theme/images/apple-touch-icon-72x72.png">
    <link rel="apple-touch-icon" sizes="114x114" href="https://penserbjorne.github.io/theme/images/apple-touch-icon-114x114.png">

    <link href="https://penserbjorne.github.io/" type="application/atom+xml" rel="alternate" title="Blog de Penserbjorne ATOM Feed" />

  </head>

  <body>

    <div class="navbar navbar-fixed-top">
      <div class="navbar-inner">
        <div class="container-fluid">
          <a class="btn btn-navbar" data-toggle="collapse" data-target=".nav-collapse">
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
            <span class="icon-bar"></span>
          </a>
          <a class="brand" href="https://penserbjorne.github.io/index.html">Blog de Penserbjorne </a>
          <div class="nav-collapse">
            <ul class="nav">
                          <li class="divider-vertical"></li>
                  <li >
                    <a href="https://penserbjorne.github.io/category/htb.html">
						<i class="icon-folder-open icon-large"></i>htb
					</a>
                  </li>
                  <li >
                    <a href="https://penserbjorne.github.io/category/init.html">
						<i class="icon-folder-open icon-large"></i>init
					</a>
                  </li>
                  <li class="active">
                    <a href="https://penserbjorne.github.io/category/pelican.html">
						<i class="icon-folder-open icon-large"></i>pelican
					</a>
                  </li>

                          <ul class="nav pull-right">
                                <li><a href="https://penserbjorne.github.io/archives.html"><i class="icon-th-list"></i>Archives</a></li>
                          </ul>

            </ul>
            <!--<p class="navbar-text pull-right">Logged in as <a href="#">username</a></p>-->
          </div><!--/.nav-collapse -->
        </div>
      </div>
    </div>

    <div class="container-fluid">
      <div class="row">
        <div class="span9" id="content">
<section id="content">
        <article>
                <header>
                        <h1>
                                <a href=""
                                        rel="bookmark"
                                        title="Permalink to Pelican (03), configuración del sitio (construcción y elementos&nbsp;básicos)">
                                        Pelican (03), configuración del sitio (construcción y elementos&nbsp;básicos)
                                </a>
<a href="http://twitter.com/share" class="twitter-share-button"
   data-count="horizontal" data-via="@_penserbjorne">Tweet</a>
<script type="text/javascript" src="http://platform.twitter.com/widgets.js">
</script>
                        </h1>
                </header>
                <div class="entry-content">
                <div class="well">
<footer class="post-info">
<span class="label">Date</span>
<abbr class="published" title="2020-08-20T00:00:00-05:00">
        <i class="icon-calendar"></i>jue 20 agosto 2020
</abbr>
<span class="label">By</span>
<a href="https://penserbjorne.github.io/author/penserbjorne.html"><i class="icon-user"></i>Penserbjorne</a>
<span class="label">Category</span>
<a href="https://penserbjorne.github.io/category/pelican.html"><i class="icon-folder-open"></i>pelican</a>.


<span class="label">Tags</span>
	<a href="https://penserbjorne.github.io/tag/blog.html"><i class="icon-tag"></i>blog</a>
	<a href="https://penserbjorne.github.io/tag/pelican.html"><i class="icon-tag"></i>pelican</a>
</footer><!-- /.post-info -->                </div>
                <h1>What is&nbsp;this?</h1>
<p>Ok, esta es la tercera entrada para trabajar generando un sitio con <code>Pelican</code> en
<code>gh-pages</code>. En esta ocasión vamos modificar algunas configuraciones para probar
y construir el sitio, así como asignarle un&nbsp;tema.</p>
<p>Te recomendamos revisar las entradas anteriores en donde fuimos construyendo
el sitio sobre el que vamos a trabajar ahora.
<a href="https://penserbjorne.github.io/pelican-01-creacion-de-un-blog-estatico-con-pelican-es-MX.html">Creación de un blog estático con Pelican</a>
y
<a href="https://penserbjorne.github.io/pelican-02-creacion-de-entradas-para-un-blog-estatico-con-pelican-es-MX.html">Creación de entradas para un blog estático con&nbsp;Pelican</a></p>
<p>Como ya hemos dicho, toda la documentación necesaria (y extendida) se
encuentra en <a href="https://docs.getpelican.com">el blog oficial de Pelican</a>, por lo
que si se necesita mayor información o detalle de algo, visitar el sitio oficial
(recuerda siempre, <strong>#<span class="caps">RTFM</span></strong>).</p>
<h1>Archivos de&nbsp;configuración</h1>
<p>Cuando comenzamos a crear el sitio utilizamos el comando <code>pelican-quickstart</code>
el cual nos creo la estructura inicial del sitio con algunos archivos de&nbsp;configuración.</p>
<p>Recordemos cual es la estructura de trabajo que tenemos hasta este&nbsp;momento:</p>
<div class="highlight"><pre><span></span><code>/path/to/project
├── bin/          <span class="c1"># carpeta de virtualenv</span>
├── include/      <span class="c1"># carpeta de virtualenv</span>
├── lib/          <span class="c1"># carpeta de virtualenv</span>
├── local/        <span class="c1"># carpeta de virtualenv</span>
├── share/        <span class="c1"># carpeta de virtualenv</span>
└── user.github.io/   <span class="c1"># carpeta del repositorio del sitio</span>
    └── pelican/      <span class="c1"># carpeta con los archivos fuente del sitio</span>
        ├── content             
        │   └── hola-mundo.md <span class="c1"># Entrada nueva</span>
        ├── output
        ├── tasks.py
        ├── Makefile
        ├── pelicanconf.py
        └── publishconf.py
</code></pre></div>


<p>Si observamos detenidamente, podemos ver que los archivos de los que hablamos se encuentran en nuestra subcarpeta <code>pelican</code> y&nbsp;son:</p>
<ul>
<li><code>Makefile</code></li>
<li><code>pelicanconf.py</code></li>
<li><code>publishconf.py</code></li>
<li><code>tasks.py</code></li>
</ul>
<p>En los archivos <code>pelicanconf.py</code> y <code>publishconf.py</code> vamos a indicar las
variables de configuración para el&nbsp;sitio.</p>
<p>Con los archivos <code>Makefile</code> y <code>tasks.py</code> vamos a indicar las acciones necesarias
para construir el&nbsp;sitio.</p>
<h1>Construcción del&nbsp;sitio</h1>
<p>Como recordaras para construir el sitio y previsualizarlo hemos estado
utilizando los siguientes&nbsp;comandos:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Generamos la salida HTML una carpeta arriba de donde estamos</span>
pelican content -o ..

<span class="c1"># Levantamos el sitio indicando la salida de los archivos HTML</span>
pelican --listen -o ..
</code></pre></div>


<p>Estos comando los podemos sustituir utilizando la herramienta
<a href="https://www.pyinvoke.org/">invoke</a> o la herramienta
<a href="https://www.gnu.org/software/make/">make</a>.</p>
<p>En este caso vamos a trabajar con <code>invoke</code> solo para variarle un poco, si te
interesa leer la versión completa o con <code>make</code> puedes
<a href="https://docs.getpelican.com/en/stable/publish.html">dar click aquí</a>.</p>
<p>Para trabajar con <code>invoke</code> necesitamos instalarlo a través de <code>pip</code>. Recuerda
hacerlo después de haber activado el entorno virtual que creamos en
<a href="https://penserbjorne.github.io/pelican-01-creacion-de-un-blog-estatico-con-pelican-es-MX.html">la primera entrada</a> y de haber entrado a la carpeta
<code>pelican</code> que se encuentra dentro del&nbsp;repositorio.</p>
<p>Para instalar <code>invoke</code> podemos ejecutar lo&nbsp;siguiente:</p>
<div class="highlight"><pre><span></span><code>python -m pip install invoke
</code></pre></div>


<p>Lo divertido de <code>invoke</code> es que funciona utilizando el archivo <code>tasks.py</code>
el cual contiene <em>tareas</em> definidas a ejecutar, básicamente es un archivo en
el que podemos automatizar tareas mediante <code>python</code>.</p>
<p>Afortunadamente el archivo <code>tasks.py</code> que tenemos ya tiene las tareas definidas
por lo cual podemos trabajar en automático con este archivo o modificarlo para
adaptarlo a nuestras&nbsp;necesidades.</p>
<p>Los comandos que vienen precargados en el archivo <code>tasks.py</code> son:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Elimina los archivos generados previamente</span>
invoke clean

<span class="c1"># Genera el sitio para ver en local</span>
invoke build

<span class="c1"># Genera el sitio para ver en local eliminando previamente los archivos generados</span>
invoke rebuild

<span class="c1"># Regenera el sitio para ver en local cada vez que se hace un cambio</span>
invoke regenerate

<span class="c1"># Permite visualizar el sitio de manera local en http://localhost:8000/</span>
invoke serve

<span class="c1"># Genera el sitio para ver en local</span>
<span class="c1"># y luego lo permite visualizar de manera local en http://localhost:8000/</span>
invoke reserve

<span class="c1"># Genera el sitio para producción</span>
invoke preview

<span class="c1"># Permite visualizar el sitio de manera local en http://localhost:8000/</span>
<span class="c1"># y regenrar el sitio cada vez que haya un cambio, todo para local</span>
invoke livereload

<span class="c1"># Permite subir el sitio al servidor correspondiente mediante rsync y SSH</span>
invoke publish

<span class="c1"># Publica el sitio de producción en Github Pages</span>
invoke gh-pages
</code></pre></div>


<p>Considerar que para el comando <code>invoke livereload</code> se requiere instalar la
herramienta <code>livereload</code> y para el comando <code>invoke gp_pages</code> se requiere la
herramienta <code>ghp-import</code>, esto lo podemos hacer mediante el siguiente&nbsp;comando:</p>
<div class="highlight"><pre><span></span><code>python -m pip install livereload ghp-import
</code></pre></div>


<p>A partir de ahora estaremos trabajando con los comandos previos. Ahora, estos
comandos requieren algunas configuraciones, por ejemplo, los comandos asociados
a generar el sitio están configurados para generar los archivos dentro de una
carpeta llamada <code>output</code> la cual se encuentra al mismo nivel que la carpeta
<code>pelican</code>. En nuestro caso como estamos trabajando con un blog para un usuario
de <code>GitHub</code> por lo que necesitamos que los archivos sean generados en el
directorio raíz del repositorio, esto es una carpeta mas arriba de donde estamos
actualmente (recuerda que estamos en la carpeta <code>pelican</code>).</p>
<p>También vamos a modificar algunas de las tareas que vienen en el archivo
<code>tasks.py</code>.</p>
<h1>Configuración de variables del&nbsp;sitio</h1>
<p>Bien, ya vimos que comandos vamos a estar utilizando y ya mencionamos que
necesitamos configurarlos, esto lo vamos a hacer en los archivos
<code>pelicanconf.py</code> y <code>publishconf.py</code>.</p>
<p>El archivo <code>pelicanconf.py</code> es utilizado para trabajar en el desarrollo local
del sitio mientras que <code>publishconf.py</code> es utilizado para producción. El archivo
<code>pelicanconf.py</code> es llamado en <code>publishconf.py</code> por lo cual las variables que se
encuentren en el segundo reescriben a las variables del primero. Por ejemplo,
si la variable <code>SITEURL</code> se encuentra asignada en ambos archivos, la de
<code>publishconf.py</code> sobreescribe a la de <code>pelicanconf.py</code>.</p>
<p>La lista de variables y su descripción la puedes encontrar
<a href="https://docs.getpelican.com/en/stable/settings.html">aquí</a>. Te recomiendo leer
este listado ya que aquí abordaremos solo algunas variables para configurar los
comando anteriores y el tema del&nbsp;sitio.</p>
<h2>Directorio de&nbsp;salida</h2>
<p>Para modificar el directorio de salida necesitamos modificar la variable
<code>OUTPUT_PATH</code> la cual tiene el valor predeterminado de <code>'output/'</code>, en este caso
vamos a modificar la variable para que el directorio de salida sea en un nivel
superior a la ruta actual por lo cual variable quedará como
<code>OUTPUT_PATH = './../'</code>.</p>
<p>Esta variable hay que asignarla en <code>pelicanconf.py</code>.</p>
<h2>Algunas otras configuraciones sencillas del sitio&nbsp;:D</h2>
<p>Bien, ya hemos modificado la ruta de salida, por lo que podemos configurar
otras variables que le dan más vida al&nbsp;sitio.</p>
<p>Las siguientes variables las configuraremos en <code>pelicanconf.py</code>:</p>
<ul>
<li><code>AUTHOR</code>: Nombre del autor del&nbsp;sitio</li>
<li><code>SITENAME</code>: Nombre del&nbsp;sitio</li>
<li><code>SITESUBTITLE</code>: Subtitulo del&nbsp;sitio</li>
<li><code>TYPOGRIFY</code>: La asignaremos como <code>True</code> para procesar las tipografías y el
texto del sitio y que tengan mejor&nbsp;presentación.</li>
<li><code>GITHUB_URL</code>: <span class="caps">URL</span> para el perfil de <code>GitHub</code>, aparecerá un botón para hacer
fork al&nbsp;sitio.</li>
<li><code>LINKS</code>: Literalmente es una lista de enlaces que quieres que aparezcan en el&nbsp;sitio.</li>
<li><code>SOCIAL</code>: La lista de enlaces a tus redes&nbsp;sociales.</li>
</ul>
<p>Tanto la sintaxxis de <code>LINKS</code> como la de <code>SOCIAL</code> es la&nbsp;siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="nv">VARIABLE</span> <span class="o">=</span> <span class="o">((</span><span class="s1">&#39;enalce 1&#39;</span>, <span class="s1">&#39;http://url-1.com/&#39;</span><span class="o">)</span>,
            <span class="o">(</span><span class="s1">&#39;enalce 2&#39;</span>, <span class="s1">&#39;http://url-2.com/&#39;</span><span class="o">)</span>,
            <span class="o">(</span><span class="s1">&#39;enalce 3&#39;</span>, <span class="s1">&#39;http://url-3.com/&#39;</span><span class="o">)</span>,<span class="o">)</span>
</code></pre></div>


<p>Las siguientes variables las configuraremos en <code>publishconf.py</code>:</p>
<ul>
<li><code>SITEURL</code>: <span class="caps">URL</span> del sitio, tiene que incluir http o https al inicio, por
ejemplo&nbsp;https://sitio.com</li>
<li><code>DELETE_OUTPUT_DIRECTORY</code>: Dado que no queremos eliminar el directorio de
salida ya que ahí se encuentra nuestra carpeta de <code>pelican</code> vamos a cambiar su
valor a <code>False</code>.</li>
</ul>
<p>Recuerda que las variables tienen un formato de <code>VARIABLE = valor</code>. El nombre
de la variable va en mayúsculas seguida de un espacio, el símbolo de <code>=</code>, otro
espacio y el valor de la&nbsp;variable.</p>
<p>Si quieres ver como van quedando los archivos de configuración de este sitio
puedes revisar el <a href="https://github.com/penserbjorne/penserbjorne.github.io/blob/master/pelican/pelicanconf.py">aquí (pelicanconf.py)</a> y
<a href="https://github.com/penserbjorne/penserbjorne.github.io/blob/master/pelican/publishconf.py">aquí (publishconf.py)</a>.</p>
<h1>Modificando el pipeline de construcción del&nbsp;sitio</h1>
<p>Ok, ya tenemos instaladas las herramientas para construir el sitio y hemos
configurado algunas variables que que tenga un poco más de personalidad el
sitio, eso significa que podemos&nbsp;generarlo.</p>
<p>Los pasos a ir siguiendo son sencillos y deben estar pensados en dos momentos:
desarrollo y&nbsp;producción.</p>
<p>Durante el desarrollo queremos ir viendo los cambios que vamos realizando en
local, así que podemos&nbsp;utilizar:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Limpiamos archivos previos</span>
invoke clean
<span class="c1"># Comenzamos a generar sobre el vuelo</span>
invoke livereload
</code></pre></div>


<p>Cuando hemos terminado de probar queremos construir el sitio para producción y
enviarlo a nuestro repositorio de <code>GitHub</code>, por lo que podemos&nbsp;utilizar:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Limpiamos archivo previos</span>
invoke clean
<span class="c1"># Generamos versión de producción y publicamos actualizaciones</span>
invoke gh-pages
</code></pre></div>


<p>Pero tenemos un problema, la tarea <code>clean</code> va a borrar todo en el contenido de
salida, esto incluiría la carpeta <code>pelican</code> por lo cual perderíamos los archivos
fuente del blog. Hay que modificar esta tarea&nbsp;:)</p>
<p>Y como queremos que todo quede en un solo comando tanto para producción como
para publicar el sitio vamos a hacer algunos cambios más que veremos a&nbsp;continuación.</p>
<p>Para modificar las tareas nos vamos a dirigir al archivo <code>tasks.py</code></p>
<h2>Modificando la tarea <code>clean</code></h2>
<p>Vamos a comentar las lineas que se encuentran dentro de la tarea y las vamos a
reemplazar por el siguiente segmento de&nbsp;código:</p>
<div class="highlight"><pre><span></span><code><span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;deploy_path&#39;</span><span class="p">]):</span>
      <span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;rm -rf ../author ../category ../drafts ../feeds ../tag ../theme &#39;</span>
              <span class="s1">&#39;../*.html&#39;</span><span class="p">)</span>
</code></pre></div>


<p>De tal modo que la tarea se vería más o menos&nbsp;así:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">clean</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Remove generated files&quot;&quot;&quot;</span>
    <span class="c1"># Old code</span>
    <span class="c1">#if os.path.isdir(CONFIG[&#39;deploy_path&#39;]):</span>
    <span class="c1">#    shutil.rmtree(CONFIG[&#39;deploy_path&#39;])</span>
    <span class="c1">#    os.makedirs(CONFIG[&#39;deploy_path&#39;])</span>

    <span class="c1">#My own code</span>
    <span class="k">if</span> <span class="n">os</span><span class="o">.</span><span class="n">path</span><span class="o">.</span><span class="n">isdir</span><span class="p">(</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;deploy_path&#39;</span><span class="p">]):</span>
        <span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;rm -rf ../author ../category ../drafts ../feeds ../tag ../theme &#39;</span>
                <span class="s1">&#39;../*.html&#39;</span><span class="p">)</span>
</code></pre></div>


<h2>Modificando la tarea <code>livereload</code></h2>
<p>Queremos que cada vez que se haga un <code>livereload</code> también se limpien los
archivos generados previamente, por lo cual vamos a añadir la tarea <code>clean</code>
dentro de <code>livereload</code>, para esto solamente añadiremos la linea <code>clean(c)</code> antes
<code>build(c)</code>, de tal modo que la tarea quedaría&nbsp;así:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">livereload</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Automatically reload browser tab upon file modification.&quot;&quot;&quot;</span>
    <span class="kn">from</span> <span class="nn">livereload</span> <span class="kn">import</span> <span class="n">Server</span>
    <span class="n">clean</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>    <span class="c1"># New line, added by me :)</span>
    <span class="n">build</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">server</span> <span class="o">=</span> <span class="n">Server</span><span class="p">()</span>
    <span class="c1"># Watch the base settings file</span>
    <span class="n">server</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;settings_base&#39;</span><span class="p">],</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">build</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
    <span class="c1"># Watch content source files</span>
    <span class="n">content_file_extensions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.md&#39;</span><span class="p">,</span> <span class="s1">&#39;.rst&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">content_file_extensions</span><span class="p">:</span>
        <span class="n">content_blob</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">/**/*</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">SETTINGS</span><span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">],</span> <span class="n">extension</span><span class="p">)</span>
        <span class="n">server</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="n">content_blob</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">build</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
    <span class="c1"># Watch the theme&#39;s templates and static assets</span>
    <span class="n">theme_path</span> <span class="o">=</span> <span class="n">SETTINGS</span><span class="p">[</span><span class="s1">&#39;THEME&#39;</span><span class="p">]</span>
    <span class="n">server</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="s1">&#39;</span><span class="si">{}</span><span class="s1">/templates/*.html&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">theme_path</span><span class="p">),</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">build</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
    <span class="n">static_file_extensions</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;.css&#39;</span><span class="p">,</span> <span class="s1">&#39;.js&#39;</span><span class="p">]</span>
    <span class="k">for</span> <span class="n">extension</span> <span class="ow">in</span> <span class="n">static_file_extensions</span><span class="p">:</span>
        <span class="n">static_file</span> <span class="o">=</span> <span class="s1">&#39;</span><span class="si">{0}</span><span class="s1">/static/**/*</span><span class="si">{1}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="n">theme_path</span><span class="p">,</span> <span class="n">extension</span><span class="p">)</span>
        <span class="n">server</span><span class="o">.</span><span class="n">watch</span><span class="p">(</span><span class="n">static_file</span><span class="p">,</span> <span class="k">lambda</span><span class="p">:</span> <span class="n">build</span><span class="p">(</span><span class="n">c</span><span class="p">))</span>
    <span class="c1"># Serve output path on configured port</span>
    <span class="n">server</span><span class="o">.</span><span class="n">serve</span><span class="p">(</span><span class="n">port</span><span class="o">=</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;port&#39;</span><span class="p">],</span> <span class="n">root</span><span class="o">=</span><span class="n">CONFIG</span><span class="p">[</span><span class="s1">&#39;deploy_path&#39;</span><span class="p">])</span>
</code></pre></div>


<h2>Modificando la tarea <code>gh-pages</code></h2>
<p>De igual manera  que en la tarea anterior, simplemente vamos a añadir la linea
de <code>clean(c)</code> para verificar que no haya basura. La linea a añadir la ubicaremos
antes de la linea <code>preview(c)</code>.</p>
<p>Y por alguna razón en este momento estamos teniendo problemas con <code>ghp-import</code>
por lo que vamos a añadir lo&nbsp;siguiente:</p>
<div class="highlight"><pre><span></span><code><span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;git add --all&#39;</span><span class="p">)</span>
<span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;git commit -m </span><span class="si">{commit_message}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">CONFIG</span><span class="p">))</span>
<span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;git push&#39;</span><span class="p">)</span>
</code></pre></div>


<p>La tarea quedaría de la siguiente&nbsp;manera:</p>
<div class="highlight"><pre><span></span><code><span class="nd">@task</span>
<span class="k">def</span> <span class="nf">gh_pages</span><span class="p">(</span><span class="n">c</span><span class="p">):</span>
    <span class="sd">&quot;&quot;&quot;Publish to GitHub Pages&quot;&quot;&quot;</span>
    <span class="n">clean</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>
    <span class="n">preview</span><span class="p">(</span><span class="n">c</span><span class="p">)</span>

    <span class="c1"># Old code</span>
    <span class="c1">#c.run(&#39;ghp-import -b {github_pages_branch} &#39;</span>
    <span class="c1">#      &#39;-m {commit_message} &#39;</span>
    <span class="c1">#      &#39;{deploy_path} -p&#39;.format(**CONFIG))</span>

    <span class="c1"># My code</span>
    <span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;git add --all&#39;</span><span class="p">)</span>
    <span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;git commit -m </span><span class="si">{commit_message}</span><span class="s1">&#39;</span><span class="o">.</span><span class="n">format</span><span class="p">(</span><span class="o">**</span><span class="n">CONFIG</span><span class="p">))</span>
    <span class="n">c</span><span class="o">.</span><span class="n">run</span><span class="p">(</span><span class="s1">&#39;git push&#39;</span><span class="p">)</span>
</code></pre></div>


<p>Podemos ver que el nombre de la función dentro de <code>tasks.py</code> lleva guion bajo
mientras que al utilizarlo con <code>invoke</code> lleva guion medio, esto no sé porque
sea pero hay que dejarlo&nbsp;así.</p>
<p>Y consideremos que dentro del archivo <code>tasks.py</code> existen las variables <code>github_pages_branch</code> y <code>commit_message</code> que son a las que se hace referencia
en la&nbsp;tarea.</p>
<h2>Pasos resultantes para construir el&nbsp;sitio</h2>
<p>Con los cambios anteriores nuestro pequeño ciclo de desarrollo&nbsp;quedaría:</p>
<div class="highlight"><pre><span></span><code><span class="c1"># Desarrollo</span>
invoke livereload

<span class="c1"># Producción</span>
invoke gh-pages
</code></pre></div>


<p>Con esto hemos automatizado un poco nuestro pequeño ciclo de desarrollo del&nbsp;sitio.</p>
<p>Para ver el archivo <code>tasks.py</code> de este blog puedes dar click
<a href="https://github.com/penserbjorne/penserbjorne.github.io/blob/master/pelican/tasks.py">aquí</a></p>
<h1>Siguientes&nbsp;pasos</h1>
<p>Ya tenemos nuestro sitio con un poco mas de estilo, sin embargo sigue sin ser
responsivo por lo cual no es fácil de leer en dispositivos con pantallas
medianas o pequeñas, el siguiente paso es configurar un tema responsivo, pero
esto lo haremos en la siguiente entrada&nbsp;:)</p>
<p>Que la fuerza te&nbsp;acompañe.</p>
                </div><!-- /.entry-content -->
        </article>
</section>
        </div><!--/span-->

                <div class="span3 well sidebar-nav" id="sidebar">
<ul class="nav nav-list">
<li class="nav-header"><h4><i class="icon-external-link"></i>blogroll</h4></li>
    <li><a href="https://lidsol.org/"><i class="icon-external-link"></i>LIDSoL</a></li>
    <li><a href="https://elotl.mx/"><i class="icon-external-link"></i>Comunidad Elotl</a></li>
    <li><a href="https://protege.la/"><i class="icon-external-link"></i>protege.la</a></li>
    <li><a href="https://socialtic.org/"><i class="icon-external-link"></i>SocialTIC</a></li>
<li class="nav-header"><h4><i class="icon-home icon-large"></i> social</h4></li>
<li><a href="https://penserbjorne.github.io/" rel="alternate"><i class="icon-bookmark icon-large"></i>atom feed</a></li>
    <li><a href="https://twitter.com/_penserbjorne"><i class="icon-twitter-sign icon-large"></i>twitter</a></li>
    <li><a href="https://github.com/penserbjorne/"><i class="icon-github-sign icon-large"></i>github</a></li>

<li class="nav-header"><h4><i class="icon-folder-close icon-large"></i>Categories</h4></li>
<li>
<a href="https://penserbjorne.github.io/category/htb.html">
    <i class="icon-folder-open icon-large"></i>htb
</a>
</li>
<li>
<a href="https://penserbjorne.github.io/category/init.html">
    <i class="icon-folder-open icon-large"></i>init
</a>
</li>
<li>
<a href="https://penserbjorne.github.io/category/pelican.html">
    <i class="icon-folder-open icon-large"></i>pelican
</a>
</li>

<li class="nav-header"><h4><i class="icon-tags icon-large"></i>Tags</h4></li>

<li class="nav-header"><h4><i class="icon-twitter-sign"></i>Twitter</h4></li>
<script charset="utf-8" src="http://widgets.twimg.com/j/2/widget.js"></script>
<script>
new TWTR.Widget({
  version: 2,
  type: 'profile',
  rpp: 4,
  interval: 30000,
  width: 'auto',
  height: 300,
  theme: {
	shell: {
	  background: '#f5f5f5',
	  color: '#000000'
	},
	tweets: {
	  background: '#ffffff',
	  color: '#000000',
	  links: '#1a50a1'
	}
  },
  features: {
	scrollbar: false,
	loop: false,
	live: false,
	behavior: 'all'
  }
}).render().setUser('@_penserbjorne').start();
</script>

</ul>        </div><!--/.well -->

      </div><!--/row-->

      <hr>

      <footer>
        <address id="about">
                Proudly powered by <a href="http://pelican.notmyidea.org/">Pelican <i class="icon-external-link"></i></a>,
                                which takes great advantage of <a href="http://python.org">Python <i class="icon-external-link"></i></a>.
        </address><!-- /#about -->

        <p>The theme is based on <a href="http://twitter.github.com/bootstrap/">Bootstrap from Twitter <i class="icon-external-link"></i></a>,
                   and <a href="http://fortawesome.github.com/Font-Awesome/">Font-Awesome <i class="icon-external-link"></i></a>, thanks!</p>
      </footer>

    </div><!--/.fluid-container-->



    <!-- Le javascript -->
    <!-- Placed at the end of the document so the pages load faster -->
    <script src="https://penserbjorne.github.io/theme/js/jquery-1.7.2.min.js"></script>
    <script src="https://penserbjorne.github.io/theme/js/bootstrap.min.js"></script>
  </body>
</html>